# 插件常见的组件

这个文档介绍了vscode中常见的组件

官网：<https://code.visualstudio.com/api/references/vscode-api>

参考文献：
- <https://github.com/Liiked/VS-Code-Extension-Doc-ZH>
- <https://liiked.github.io/VS-Code-Extension-Doc-ZH/#/>


<br/>


目录：

- [插件常见的组件](#插件常见的组件)
- [一. 布局](#一-布局)
	- [1.1 通知](#11-通知)
		- [1.1.1 使用方式](#111-使用方式)
	- [1.2 进度条](#12-进度条)
- [二、配置](#二配置)
- [三、键位绑定](#三键位绑定)
- [四、菜单](#四菜单)
- [五、数据存储](#五数据存储)
- [命令行执行](#命令行执行)





# 一. 布局

参考文档：
- <https://code.visualstudio.com/api/ux-guidelines/overview>
- <https://code.visualstudio.com/api/extension-capabilities/extending-workbench>


VS code界面布局可以分成2个部分：Container（容器）和 Items（内容）。

- 容器： 容器（Containers）是界面中固定的区域框架，是界面的结构性区域，提供特定的功能框架。
- 内容： 内容（Items）则是容器（Containers）里填充的具体功能或信息，是容器中具体的、可交互的功能单元。

<br>

VS Code界面的容器如下，由Activity Bar （活动栏）、Primary Sidebar（主侧边栏）、Editor（编辑区域）、Secondary Sidebar（辅助边栏/次侧边栏）、Status Bar（状态栏）、Panel（面板）组成。

![image-20260112172523842](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/image-20260112172523842.png)


容器栏介绍：
- 活动栏: 提供视图图标，如资源管理器、搜索、源代码管理、扩展等，用于切换主侧边栏的视图
- 主侧边栏: 显示视图 (Views)，例如文件树、搜索结果的列表、Git 面板等。其内容随活动栏选中的项目变化
- 辅助边栏/次侧边栏: 功能与主侧边栏类似， 通常作为辅助显示区域，用户可以将终端等问题视图拖动到此处
- 编辑器区域: 代码编辑的核心区域，可同时打开多个编辑器标签页，支持分组（Editor Groups）和分屏
- 面板: 底部的视图容器，集成了终端、问题列表、输出、调试控制台等
- 状态栏：底部的信息栏，显示状态项，如 Git 分支、错误警告数、行号、编码格式等


![alt text](./5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/image.png)

常见组件介绍：
- 视图 (View)：在视图容器（如侧边栏、面板）中呈现内容的核心单元，主要有树形视图、欢迎视图、Webview视图三种形式。用户可将视图拖拽到界面的其他区域（如从侧边栏移到面板）
- 视图工具栏 (View Toolbar)：附加在特定视图上的工具栏，其上的操作按钮仅作用于当前所在的视图
- 侧边栏工具栏 (Sidebar Toolbar)：作用于整个视图容器的工具栏。例如，在资源管理器视图的顶部，提供“新建文件”、“新建文件夹”等容器级操作
- 编辑器工具栏 (Editor Toolbar)：出现在编辑器区域顶部的工具栏，提供与当前打开的文件或编辑器类型强相关的操作，如“格式化文档”
- 面板工具栏 (Panel Toolbar)：位于面板区域的工具栏，其显示的操作与面板中当前选中的视图标签页紧密相关。例如，切换到“终端”视图和“问题”视图，面板工具栏的按钮会不同
- 状态栏项目 (Status Bar Item)：显示在窗口底部状态栏上的信息项。左侧项目通常与整个工作区相关（如Git分支），右侧项目则与当前活动文件相关（如行号、编码格式）


接下来就介绍一下vscode中常见布局相关的功能

参考文献：

<https://rackar.github.io/vscode-ext-doccn/extension-capabilities/common-capabilities.html>



案例：component

```bash
test@test:~/github/vscode-plugin-tutorial/src$ yo code

     _-----_     ╭──────────────────────────╮
    |       |    │   Welcome to the Visual  │
    |--(o)--|    │   Studio Code Extension  │
   `---------´   │        generator!        │
    ( _´U`_ )    ╰──────────────────────────╯
    /___A___\   /
     |  ~  |     
   __'.___.'__   
 ´   `  |° ´ Y ` 

✔ What type of extension do you want to create? New Extension (TypeScript)
✔ What's the name of your extension? common_components
✔ What's the identifier of your extension? component
✔ What's the description of your extension? common components of vscode
✔ Initialize a git repository? No
✔ Which bundler to use? unbundled
✔ Which package manager to use? npm

Writing in /home/test/github/vscode-plugin-tutorial/src/component...
   create component/.vscode/extensions.json
   create component/.vscode/launch.json
   create component/.vscode/settings.json
   create component/.vscode/tasks.json
   create component/package.json
   create component/tsconfig.json
   create component/.vscodeignore
   create component/vsc-extension-quickstart.md
   create component/README.md
   create component/CHANGELOG.md
   create component/src/extension.ts
   create component/src/test/extension.test.ts
   create component/.vscode-test.mjs
   create component/eslint.config.mjs

Changes to package.json were detected.

Running npm install for you to install the required dependencies.

added 242 packages, and audited 243 packages in 27s

74 packages are looking for funding
  run `npm fund` for details

3 low severity vulnerabilities

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.

Your extension component has been created!

To start editing with Visual Studio Code, use the following commands:

     code component

Open vsc-extension-quickstart.md inside the new extension for further instructions
on how to modify, test and publish your extension.

For more information, also visit http://code.visualstudio.com and follow us @code.


? Do you want to open the new folder with Visual Studio Code?
❯ Open with `code`
  Skip
```


![image-20260115135732257](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/image-20260115135732257.png)


## 1.1 通知

几乎所有的插件都需要在某些时候为用户提示信息。VS Code提供了3个API来展示不同重要程度的信息：

- 消息：window.showInformationMessage
- 警告：window.showWarningMessage
- 错误：window.showErrorMessage


API原型（来自node_modules/@type/vscode/index.d.ts）:

```typescript
export function showInformationMessage<T extends string>(message: string, ...items: T[]): Thenable<T | undefined>;
export function showInformationMessage<T extends string>(message: string, options: MessageOptions, ...items: T[]): Thenable<T | undefined>;
export function showInformationMessage<T extends MessageItem>(message: string, ...items: T[]): Thenable<T | undefined>;
export function showInformationMessage<T extends MessageItem>(message: string, options: MessageOptions, ...items: T[]): Thenable<T | undefined>;

export function showWarningMessage<T extends string>(message: string, ...items: T[]): Thenable<T | undefined>;
export function showWarningMessage<T extends string>(message: string, options: MessageOptions, ...items: T[]): Thenable<T | undefined>;
export function showWarningMessage<T extends MessageItem>(message: string, ...items: T[]): Thenable<T | undefined>;
export function showWarningMessage<T extends MessageItem>(message: string, options: MessageOptions, ...items: T[]): Thenable<T | undefined>;

export function showErrorMessage<T extends string>(message: string, ...items: T[]): Thenable<T | undefined>;
export function showErrorMessage<T extends string>(message: string, options: MessageOptions, ...items: T[]): Thenable<T | undefined>;
export function showErrorMessage<T extends MessageItem>(message: string, ...items: T[]): Thenable<T | undefined>;
export function showErrorMessage<T extends MessageItem>(message: string, options: MessageOptions, ...items: T[]): Thenable<T | undefined>;
```

可以看出Info，Warning，Error这3个API原型是一致的，核心参数包括message（必填的消息内容）、item（可选的操作按钮）和options（配置选项）。下面是一个完整的API参数案例。

注意：options中常见的属性是modal，若设置为true，消息框会以模态形式弹出（在vscode中间），用户必须处理它才能继续工作，适合非常严重的错误。



```typescript
vscode.window.showErrorMessage('这是错误消息', // 必填的消息内容
  { modal: true, detail: '详细信息：发生了一个错误，请重试。' }, // 可选的操作按钮
  { title: '重试' }, // 配置选项
  { title: '取消' }
).then(selection => { // 配置选项后续的操作
  if (selection) {
    if (selection.title === '重试') {
      vscode.window.showInformationMessage('您选择了重试。');
    } else if (selection.title === '取消') {
      vscode.window.showInformationMessage('您选择了取消。');
    }
  } else {
    vscode.window.showInformationMessage('您关闭了消息框。');
  }
});	
```
对应截图如下：

modal为true时，会在vscode界面中央弹出一个对话框，主题不一致。

![image-20260115153121578](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/image-20260115153121578.png)


modal为false或者不设置（默认为false），默认会在vscode右下角弹出一个对话框，主题和message一致。

![image-20260115154639435](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/image-20260115154639435.png)


### 1.1.1 使用方式

在 VS Code 插件开发中，window.showInformationMessage、window.showWarningMessage和 window.showErrorMessage这三个 API 均为异步接口。
当这些消息提示包含交互按钮时，其异步特性尤为明显。
为确保在具有多个交互步骤的复杂场景中，异步代码的执行流程与整体业务逻辑保持一致，可以采用 async/await语法或 .then()链式调用的方式，来有序地处理这些异步操作。

方法1：使用async/await时，结合try...catch

```typescript
// 在执行第一个交互式操作之后，再执行第二个交互式操作
// 在某个位置插入调用fun0和fun1即可，注意，这个函数也需要使用async函数声明
await fun0(); 
await fun1();

async function fun0() {
	try {
		await vscode.window.showErrorMessage('这是错误消息',
			{ modal: true, detail: '详细信息：发生了一个错误，请重试。' },
			{ title: '重试' },
			{ title: '取消' }
		).then(selection => {
			if (selection) {
				if (selection.title === '重试') {
					vscode.window.showInformationMessage('您选择了重试。');
				} else if (selection.title === '取消') {
					vscode.window.showInformationMessage('您选择了取消。');
				}
			} else {
				vscode.window.showInformationMessage('您关闭了消息框。');
			}
		});	
	} catch (error) {
		console.error(error);
		vscode.window.showErrorMessage('显示错误消息时出错。');
	}
}

async function fun1() {
	try {
		await vscode.window.showErrorMessage('这是错误消息',
			{ title: '重试' },
			{ title: '取消' }
		).then(selection => {
			if (selection) {
				if (selection.title === '重试') {
					vscode.window.showInformationMessage('您选择了重试。');
				} else if (selection.title === '取消') {
					vscode.window.showInformationMessage('您选择了取消。');
				}
			} else {
				vscode.window.showInformationMessage('您关闭了消息框。');
			}
		});	
	} catch (error) {
		console.error(error);
		vscode.window.showErrorMessage('显示错误消息时出错。');
	}
}
```

方法2：使用.then()链式调用

```typescript
// 在段落中调用fun2即可
fun2();

function fun2() {
	vscode.window.showErrorMessage('这是错误消息',
		{ modal: true, detail: '详细信息：发生了一个错误，请重试。' },
		{ title: '重试' },
		{ title: '取消' }
	).then(selection => {
		if (selection) {
			if (selection.title === '重试') {
				vscode.window.showInformationMessage('您选择了重试。');
				fun3();
			} else if (selection.title === '取消') {
				vscode.window.showInformationMessage('您选择了取消。');
				fun3();
			}
		} else {
			vscode.window.showInformationMessage('您关闭了消息框。');
			fun3();
		}
	});	
}

function fun3() {
	try {
		vscode.window.showErrorMessage('这是错误消息',
			{ title: '重试' },
			{ title: '取消' }
		).then(selection => {
			if (selection) {
				if (selection.title === '重试') {
					vscode.window.showInformationMessage('您选择了重试。');
				} else if (selection.title === '取消') {
					vscode.window.showInformationMessage('您选择了取消。');
				}
			} else {
				vscode.window.showInformationMessage('您关闭了消息框。');
			}
		});	
	} catch (error) {
		console.error(error);
		vscode.window.showErrorMessage('显示错误消息时出错。');
	}
}
```


## 1.2 进度条

使用vscode.Progress将处理进度报告给用户。

通过ProgressLocation选项，进度可以显示在不同的区域：
- 显示在通知区
- 显示在源控制视图
- VS Code窗口中的通用进度条位置

<br>

API原型（来自node_modules/@type/vscode/index.d.ts）:


参考文档：
- <https://code.visualstudio.com/api/references/vscode-api>
- https://code.visualstudio.com/api/ux-guidelines/notifications



```bash
export function withProgress<R>(options: ProgressOptions, task: (progress: Progress<{
  message?: string;
  increment?: number;
}>, token: CancellationToken) => Thenable<R>): Thenable<R>;
```

原型分析：

- options: 一个ProgressOptions对象，描述用于显示进度的选项，比如其位置，位置可以为：
  - SourceControl：源代码控制视图，进度信息会显示在源代码管理视图的图标上作为叠加层，同时在该视图内部也会显示进度条，不支持取消，不支持离散进度条，无法描述操作细节。
  - Windows: 编辑器窗口状态栏，进度会直接显示在VS Code窗口底部的状态栏（Status Bar）​ 中，支持在进度文本中使用 $(icon-name)语法来显示主题图标，增强可视化效果，不支持取消，不支持离散进度报告，支持主题图标。
  - Notification: 通知弹出框，进度会以弹出通知的形式显示在界面右下角。它可以显示确定性进度（有明确完成百分比）和不确定性进度（无限循环动画），并提供一个可选的取消按钮。支持取消，支持离散进度条，不支持渲染图标。
- message：
- increment: 每次进度条增加的值，直到100
- token: 提供了CancellationToken监控用户是否取消了工作

注意：离散进度报告，指的是是否可以分解为多个明确步骤的进度，例如0% -> 10% -> 100%。


案例：

```typescript
async function fun4() {
  await notification_progress_without_progressbar_and_cancel();
	await notification_progress_with_cancel();
	await notification_progress_without_cancel();
	await source_control_progress();
	await window_progress();
}

async function notification_progress_without_progressbar_and_cancel() {
    await vscode.window.withProgress({
        location: vscode.ProgressLocation.Notification,
        title: "正在执行任务...",
        cancellable: true
    }, async (progress) => {
        // 不报告具体进度增量，只显示不确定的进度动画
        progress.report({ message: "任务处理中，请稍候..." });
        // 模拟任务执行时间
        await new Promise(resolve => setTimeout(resolve, 5000));
        vscode.window.showInformationMessage('任务完成！');
    });
}

async function notification_progress_with_cancel() {
	await vscode.window.withProgress({
		location: vscode.ProgressLocation.Notification,
		title: "正在执行任务...",
		cancellable: false
	}, async (progress) => {
		for (let i = 0; i <= 100; i += 10) {
			progress.report({ increment: 10, message: `完成 ${i}%` });
			await new Promise(resolve => setTimeout(resolve, 500));
		}
		vscode.window.showInformationMessage('任务完成！');
	});
}

async function notification_progress_without_cancel() {
	await vscode.window.withProgress({
		location: vscode.ProgressLocation.Notification,
		title: "正在执行任务...",
		cancellable: true
	}, async (progress) => {
		for (let i = 0; i <= 100; i += 10) {
			progress.report({ increment: 10, message: `完成 ${i}%` });
			await new Promise(resolve => setTimeout(resolve, 500));
		}
		vscode.window.showInformationMessage('任务完成！');
	});
}

async function source_control_progress() {
	await vscode.window.withProgress({
		location: vscode.ProgressLocation.SourceControl,
		title: "正在执行任务...",
		cancellable: true
	}, async (progress) => {
		for (let i = 0; i <= 100; i += 10) {
			progress.report({ increment: 10, message: `完成 ${i}%` });
			await new Promise(resolve => setTimeout(resolve, 500));
		}
		vscode.window.showInformationMessage('任务完成！');
	});
}


async function window_progress() {
	await vscode.window.withProgress({
		location: vscode.ProgressLocation.Window,
		title: "正在执行任务...",
		cancellable: true // 支持拒绝
	}, async (progress) => {
		for (let i = 0; i <= 100; i += 10) {
			progress.report({ increment: 10, message: `完成 ${i}%` });
			await new Promise(resolve => setTimeout(resolve, 500));
		}
		vscode.window.showInformationMessage('任务完成！');
	});
}

```

运行环境如下：


带拒绝按钮的通知栏的进度条：有拒绝，但是没有进度条

![](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/progress5.gif)




不带拒绝按钮的通知栏的进度条：没有拒绝，但是有进度条

![](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/progress1.gif)



带拒绝按钮的通知栏的进度条：有拒绝，有进度条

![](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/progress2.gif)



源代码控制视图的进度条：无法实现拒绝，但存在进度条

![](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/progress3.gif)


编辑器窗口状态栏：支持拒绝，存在进度条，点击变成通知栏进度条

![](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/progress4.gif)




# 二、配置

插件需要在contributes.configuration发布内容配置点中填写有关的配置，你可以workspace.getConfiguration API中阅读有关内容


参考文献：
- <https://code.visualstudio.com/api/ux-guidelines/settings>
- <https://code.visualstudio.com/api/references/vscode-api#workspace.getConfiguration>
- <https://code.visualstudio.com/api/references/contribution-points#contributes.configuration>


设置是提供给用户配置扩展插件的方式，可以是输入框、布尔值、下拉选单、列表、键值对。


## 2.1 实现方法

在开发VS Code插件时实现配置选项，具体步骤为：在package.json中定义配置项，然后在代码中读取/更新配置。


步骤一：定义配置项（package.json）

首先在package.json文件中的contributes字段中增加configuration字段，定义配置项

```json
"configuration": {
	"title": "My Extension Configuration", // 在设置中配置的扩展名称
	"type": "object",
	"properties": {
		"myextension.int_var": { // 参数的实际调用的符号
			"type": "integer", // 参数的类型
			"default": 1, // 默认值
			"minimum": 1, // 最小值
			"maximum": 50, // 最大值
			"description": "Defines the number allowed (1-50), recommended value <= 10." // 配置参数的描述
		}
	}
}
```

package.json截图如下：

![image-20260116175953627](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/image-20260116175953627.png)


插件配置如图所示：

![image-20260116180043562](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/image-20260116180043562.png)


步骤二：读取/更新/检测配置

```typescript
// 读取配置
let parallel_num: number = vscode.workspace.getConfiguration('myextension').get<number>('integer', 1);

const config = vscode.workspace.getConfiguration('myextension');
const parallel_num = config.get<number>('integer', 1);


// 更新配置, 这个需要使用async声明
await config.update('interger', 3);
```


## 2.2 详情

参考文献：<https://code.visualstudio.com/api/references/contribution-points#contributes.configuration>

配置模式：

![image-20260117155837521](5.%E6%8F%92%E4%BB%B6%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BB%84%E4%BB%B6.assets/image-20260117155837521.png)


- \[1\]: 对应的是configuration中的title字段，表示配置组的显示标题。
- \[2\]: 代表的是配置中的对象，对应的是configuration中的properties字段，是一个字典/键值对（key:value）对象，其中key为配置的唯一标识符，格式通常为extensionName.settingName，value为配置项的详细定义对象。key必须全局唯一，且不能为其他ID的前缀。key提供了设置/更新配置选项的作用。
- \[3\]: 代表的是配置中的描述，对应的是configuration中的description字段，会出现在标题之后和输入字段之前，布尔值的话，描述会作为复选框的标签。相似的字段还有markdownDescription，但是markdownDescription会解析为Markdown。
- \[4\]、\[5\]和\[6\]: 代表的是配置选项的类型，对应的type字段分别为：number、string、boolean。这些type字段具体为：
  - string，字符串类型，可使用"editPresentation": "multilineText"实现多行文本输入；
  - boolean，布尔类型，在界面中显示为复选框，描述（markdownDescription和description）作为复选框标签；
  - object，对象类型，复杂结构，需定义 properties子属性；
  - array，数组类型，需定义 items指定数组元素类型；
  - number，数字类型，可设置 minimum、maximum等约束；
  - integer，整数类型，可设置 minimum、maximum等约束；
- \[7\]: 使用enum属性设置数组的话，设置界面会渲染出这些物品的下拉菜单。enumDescriptions/markdownEnumDescriptions属性会在设置界面下拉菜单底部为每个枚举项提供描述。 也可以使用enumItemLabels字段来配置自定义下拉选项名称。
- \[8\]: 对于 object类型等复杂配置，用户通常只能通过[8]所描述的settings.json文件的入口，无法通过常规表单编辑。


注意：
- markdownEnumDescriptions优于enumDescriptions。
- deprecationMessage或markdownDeprecationMessage，弃用消息，设置项会显示黄色警告下划线、会显示你指定的弃用指示信息，宾从设置界面自动隐藏（除非用户已经配置该设置）。
- default字段则是配置选项的默认值。
- minimum、maximum字段用来限制数值（number和interger）的最小值和最大值。
- pattern​字段用于将字符串限制到给定正则表达式的模式
- patternErrorMessage​字段当模式不匹配时提供定制错误信息
- format​字段用于将字符串限制为已知格式，例如日期、时间、IPv4、电子邮件和URI
- maxItems、minItems​字段用于限制数组长度
- editPresentation​字段用于控制在设置编辑器中字符串设置是渲染为单行输入框还是多行文本区域
- scope字段：配置作用域决定了设置何时通过设置编辑器对用户可用，以及设置是否适用。如果未声明作用域，默认值为 window。字段值可能是以下值之一：
  - application​ - 应用于所有 VS Code 实例的设置，且只能在用户设置中配置。
  - machine​ - 机器特定设置，只能在用户设置或远程设置中配置。例如，不应在不同机器间共享的安装路径。这些设置的值不会同步。
  - machine-overridable​ - 机器特定设置，可以被工作区或文件夹设置覆盖。这些设置的值不会同步。
  - window​ - 窗口（实例）特定设置，可以在用户、工作区或远程设置中配置。
  - resource​ - 资源设置，适用于文件和文件夹，可以在所有设置级别（包括文件夹设置）中配置。
  - language-overridable​ - 可以在语言级别覆盖的资源设置。

其他的配置见 [官方参考文献](https://code.visualstudio.com/api/references/contribution-points#contributes.configuration)。

<br>



# 三、键位绑定

插件可以添加自定义键位映射，在contributes.keybindings和键位绑定中了解更多有关内容


参考文献: <https://code.visualstudio.com/docs/configure/keybindings#_advanced-customization>


# 四、菜单

插件可以自定义上下文菜单项，菜单会根据用户右击VS Code UI的不同位置而各不相同。查看更多contributes.menus发布内容配置


# 五、数据存储

参考文献：<https://vscode.github.net.cn/api/extension-capabilities/common-capabilities>

VS Code中有四种数据储存方式：

- `ExtensionContext.workspaceState`：键值对组成的工作区数据。当同一个工作区再次打开时会重新取出数据。
- `ExtensionContext.globalState`：键值对组成的全局数据。当插件激活时会再次取出这些数据。
- `ExtensionContext.storagePath`：指向你的插件可以读写的本地文件夹的路径。如果你要储存比较大的数据，这是一个非常好的选择。
- `ExtensionContext.globalStoragePath`：指向你的插件可以读写的本地存储的路径。如果你要存储所有工作区内的大文件，这时一个非常好的选择


# 六、命令行执行

VS Code中有以下几种命令行执行方式：

- 异步spwan方法
- 同步exec方法
- 自带的executeCommand方法

## 6.1 spwan方法

使用child_process.spawn() API启动子进程，用于与外部程序进行通信。

```typescript
import { spawn } from 'child_process';

const taskProcess = spawn('python3', ["main.py", "1"], {
	shell: true,
	cwd: workspacePath,
});

taskProcess.stdout?.on('data', (data) => {
	const output = data.toString();
	outputChannel.append(output);
});

taskProcess.stderr?.on('data', (data) => {
	const output = data.toString();
	outputChannel.append(output);
});

taskProcess.on('error', (err) => {
	return;
});

taskProcess.on('close', (code) => {
	console.log("close代码:", code);
});
```


## 6.2 exec方法

使用child_process.exec() API在shell中执行命令。

```typescript
import { exec } from 'child_process';

command = "python main.py 1";
exec(command, (error, stdout, stderr) => {
	if (error) {
		outputChannel.appendLine(`终止子进程 错误信息: ${error.message}`);
		return;
	}
	if (stderr) {
		outputChannel.appendLine(`终止子进程 标准错误: ${stderr}`);
		return;
	}
	outputChannel.appendLine(`终止子进程 输出: ${stdout}`);
});
```


## 6.3 executeCommand方法


参考文献：<https://rackar.github.io/vscode-ext-doccn/extension-guides/command.html>


vscode.commands.executeCommand API可以程序性的调用一个命令，下面命令可以奖当前选中行变成注释。

```typescript
import * as vscode from 'vscode';

function commentLine() {
	vscode.commands.executeCommand('editor.action.addCommentLine');
}
```
