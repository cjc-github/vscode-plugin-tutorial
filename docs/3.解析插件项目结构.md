# 解析插件项目结构

在vscode插件开发环境搭建时，就运行了一个helloworld实例，以该源码部分的目录结构为例，介绍一下插件的项目结构。

```bash
.
├── .vscode
│   ├── launch.json     // 插件加载和调试的配置
│   └── tasks.json      // 配置TypeScript编译任务
├── .gitignore          // 忽略构建输出和node_modules文件
├── README.md           // 一个友好的插件文档
├── src
│   └── extension.ts    // 插件源代码
├── package.json        // 插件配置清单
├── tsconfig.json       // TypeScript配置
```

插件的关键部分： `package.json` 和 `extension.ts` 文件。

## 1. package.json文件

VS Code插件必须包含一个插件配置清单，package.json文件，它加入了一些Node.js字段和一些VS Code独有的字段。

```json
{
  "name": "helloworld",                       // 插件的名称，通常用小写字母，并且不能包含空格。
  "displayName": "helloworld",                 // 插件的显示名称，用于在 VS Code 的扩展市场中展示。
  "description": "this is a helloworld item",  // 插件的简要描述，介绍插件的功能。
  "version": "0.0.1",                          // 插件的版本号，遵循语义版本控制（SemVer）规则。
  "engines": {                                 // 指定兼容的 VS Code 版本。
    "vscode": "^1.107.0"
  },
  "categories": [                              // 插件在市场中的分类。
    "Other"
  ],
  "activationEvents": [],                      // 激活插件的事件，当特定事件触发时，插件会被激活。
  "main": "./out/extension.js",                // 插件的入口文件，VS Code 加载插件时首先执行的文件。
  "contributes": {                             // 插件的功能配置和贡献内容。
    "commands": [                               // 注册插件命令，使得用户可以在命令面板中访问
      {
        "command": "helloworld.helloWorld",   // 定义的命令标识符，用于与插件功能关联。
        "title": "Hello World"                 // 命令在命令面板中的显示名称。
      }
    ]
  },
  "scripts": {                                 // 定义可以在终端中运行的 npm 脚本。
    "vscode:prepublish": "npm run compile",    // 在发布前自动编译 TypeScript 代码。
    "compile": "tsc -p ./",                    // 编译 TypeScript 代码的命令。
    "watch": "tsc -watch -p ./",               // 监视文件变化并自动编译。
    "pretest": "npm run compile && npm run lint", // 在运行测试之前先编译和检查代码格式。
    "lint": "eslint src",                       // 检查 src 目录中的代码格式。
    "test": "vscode-test"                       // 运行 VS Code 的测试框架。
  },
  "devDependencies": {                         // 插件开发所需的依赖项。
    "@types/vscode": "^1.107.0",              // VS Code 的类型定义，供 TypeScript 使用。
    "@types/mocha": "^10.0.10",               // Mocha 的类型定义，用于单元测试。
    "@types/node": "22.x",                     // Node.js 的类型定义。
    "typescript-eslint": "^8.48.1",            // 用于将 TypeScript 与 ESLint 结合的包。
    "eslint": "^9.39.1",                       // JavaScript 和 TypeScript 的代码质量检查工具。
    "typescript": "^5.9.3",                    // TypeScript 的核心库。
    "@vscode/test-cli": "^0.0.12",            // VS Code 测试 CLI，简化测试运行。
    "@vscode/test-electron": "^2.5.2"         // 用于在 Electron 环境下测试的包。
  }
}
```

## 2. extension.ts文件

```typescript
// 模块 'vscode' 包含了 VS Code 扩展 API
// 导入该模块，并在以下代码中使用别名 vscode
import * as vscode from 'vscode';

// 当你的扩展被激活时调用此方法
// 当第一次执行命令时，你的扩展会被激活
export function activate(context: vscode.ExtensionContext) {

    // 使用控制台输出诊断信息 (console.log) 和错误 (console.error)
    // 这一行代码将在你的扩展被激活时仅执行一次
    console.log('恭喜你，扩展 "helloworld" 现在已激活！');

    // 命令已在 package.json 文件中定义
    // 现在通过 registerCommand 提供命令的实现
    // commandId 参数必须与 package.json 中的命令字段匹配
    const disposable = vscode.commands.registerCommand('helloworld.helloWorld', () => {
        // 你在这里放置的代码将在每次执行命令时被执行
        // 向用户显示消息框
        vscode.window.showInformationMessage('来自 helloworld 的 Hello World！');
    });

    context.subscriptions.push(disposable);
}

// 当你的扩展被停用时调用此方法
export function deactivate() {}
```

描述：

- `activate函数:` 当扩展首次被执行时，activate 函数被调用，注册并实现了一个名为 helloworld.helloWorld 的命令，该命令执行时展示一个信息框。
- `deactivate函数:` 在扩展被停用时执行。


# 常见的操作场景

## 1.1 菜单项


之前的案例执行VSCode插件命令是通过Ctrl+Shift+P打开命令行面板执行的。这里介绍一下使用菜单选项执行插件命令。

案例：menu


![alt text](image.png)




